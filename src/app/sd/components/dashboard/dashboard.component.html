<div class="row">
  <div class="col-md-12">
    <div class="content-container">
      <div class="row">
        <div class="col">
          <div class="row">
            <div class="col">
              <div class="content-medium">
                <div class="content-header">
                  Мэдэгдэл
                </div>
                <div class="content-body">
                  <app-inline-loader *ngIf="loading_message"></app-inline-loader>
                  <div *ngIf="message!=undefined">
                    <div class="message-title">
                      {{message.title}}
                    </div>
                    <div class="message-date">
                      {{message.regdate}}
                    </div>
                    <div class="message-desc">
                      {{message.desc}}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="content-small">
                <div class="content-header">
                  Гэрээний мэдээлэл
                </div>
                <div class="content-body">
                  <app-inline-loader *ngIf="loading_contract"></app-inline-loader>
                  <div *ngIf='contract!=undefined' class="list-group">
                    <div class="list-group-item-line" *ngIf='contract.bdate!=undefined'>
                      <div class="row">
                        <div class="col-md-5 ">Гэрээний дугаар</div>
                        <div class="col-md-7 font-weight-bold">{{contract.id}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5 ">Гэрээний урт</div>
                        <div class="col-md-7 font-weight-bold">{{contract.Length}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line" *ngIf='contract.bdate!=undefined'>
                      <div class="row">
                        <div class="col-md-5 ">Гэрээний хугацаа</div>
                        <div class="col-md-7 font-weight-bold">{{contract.bdate}} - {{contract.edate}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Төлбөр төлөх давтамж</div>
                        <div class="col-md-7 font-weight-bold">{{contract.Period.name}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Сарын орлого</div>
                        <div class="col-md-7 font-weight-bold">{{contract.Income}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Сарын шимтгэл</div>
                        <div class="col-md-7 font-weight-bold">{{contract.Fee}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Ажил, мэргэжил</div>
                        <div class="col-md-7 font-weight-bold">{{contract.AMClass.name}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Төлбөр төлөх банк</div>
                        <div class="col-md-7 font-weight-bold">{{contract.Bank.dans}} - {{contract.Bank.name}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Бүртгэсэн огноо</div>
                        <div class="col-md-7 font-weight-bold">{{contract.RegDate}}</div>
                      </div>
                    </div>
                    <div class="list-group-item-line">
                      <div class="row">
                        <div class="col-md-5">Төлөв</div>
                        <div class="col-md-7">
                          <span class="badge" [class.badge-primary]='contract.Status.id==1'
                            [class.badge-success]='contract.Status.id==2'>{{contract.Status.name}}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div *ngIf='contract==undefined || contract==null'>
                    <div>
                      Гэрээ байгуулаагүй байна. Гэрээ байгаалах бол <a [routerLink]="['/main/view/sd/register']">энд
                        дарж</a>
                      гэрээний байгуулах
                      хүсэлтээ явуулна уу
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="content-small">
            <div class="content-header">
              Төлбөрийн мэдээлэл
            </div>
            <div class="content-body">
              <div class="row" *ngIf='lastPayment!=undefined'>
                <div class="col-md-7">
                  <ul class="list-group">
                    <li class="list-group-item lightgray">
                      {{lastPayment.CalYear}} оны {{lastPayment.CalMonth}} сар хүртэлх төлбөр
                    </li>
                    <li class="list-group-item">
                      <div class="row">
                        <span class="col-md-8">Төлөх дүн</span>
                        <span class="col-md-4 text-right font-weight-bold">{{lastPayment.PayAmount}}</span>
                      </div>
                    </li>
                    <li class="list-group-item">
                      <div class="row">
                        <span class="col-md-8">Алданги</span>
                        <span class="col-md-4 text-right font-weight-bold">{{lastPayment.ald}}</span>
                      </div>
                    </li>
                    <li class="list-group-item">
                      <div class="row">
                        <span class="col-md-8">Нийт дүн: </span>
                        <span class="col-md-4 text-right font-weight-bold">{{lastPayment.Amount}}</span>
                      </div>
                    </li>
                  </ul>
                </div>
                <div class="col-md-5">
                  <button class="btn btn-default">Төлбөр төлөх</button>
                  <br>
                  <br>
                  <div class="alert alert-primary">
                    Дараагийн төлбөр төлөх хугацаа {{lastPayment.nextDate}}
                  </div>
                </div>
              </div>
              <br>
              <app-inline-loader *ngIf="loading_payment"></app-inline-loader>
              <div *ngIf="payment!=undefined">
                <div class="table-responsive">
                  <table class="table table-bordered table-sm">
                    <thead>
                      <tr>
                        <th scope="col" class="text-center">Он</th>
                        <th scope="col" class="text-center">Сар</th>
                        <th scope="col" class="text-center">Төлөх дүн</th>
                        <th scope="col" class="text-center">Төлсөн</th>
                        <th scope="col" class="text-center">Төлөв</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-template ngFor let-item [ngForOf]="payment">
                        <tr (click)='selectPayment(item)'>
                          <td class="text-center" style="width: 50px;">{{item.CalYear}}</td>
                          <td class="text-center" style="width: 50px;">{{item.CalMonth}}</td>
                          <td class="text-right" style="min-width: 80px;">{{item.Amount}}</td>
                          <td class="text-right" style="min-width: 80px;">{{item.Paid}}</td>
                          <td class="text-center" style="max-width: 100px; min-width: 80px;"><span class='badge'
                              [class.badge-primary]='item.Status.id==0'
                              [class.badge-success]='item.Status.id==1'>{{item.Status.name}}</span>
                          </td>
                        </tr>
                        <tr *ngIf='expanded && item==selectedPayment && item.Paid>0'>
                          <td colspan="6" style="padding: 0; margin: 0;">

                            <div class="row">
                              <div class="col-md-6" style="padding: 0; margin: 0;">
                                <ul class="list-group" style="margin: 0;">
                                  <li class="list-group-item lightgray">
                                    Төлөх төлбөр
                                  </li>
                                  <li class="list-group-item">
                                    <div class="row">
                                      <span class="col-md-8">Төлөх дүн</span>
                                      <span class="col-md-4 text-right font-weight-bold">{{item.PayAmount}}</span>
                                    </div>
                                  </li>
                                  <li class="list-group-item">
                                    <div class="row">
                                      <span class="col-md-8">Алданги</span>
                                      <span class="col-md-4 text-right font-weight-bold">{{item.ald}}</span>
                                    </div>
                                  </li>
                                  <li class="list-group-item">
                                    <div class="row">
                                      <span class="col-md-8">Нийт дүн: </span>
                                      <span class="col-md-4 text-right font-weight-bold">{{item.Amount}}</span>
                                    </div>
                                  </li>
                                </ul>
                              </div>
                              <div class="col-md-6" style="padding: 0; margin: 0;">
                                <ul class="list-group" style="margin: 0;">
                                  <li class="list-group-item lightgray">
                                    Төлсөн төлбөр
                                  </li>
                                  <li class="list-group-item" *ngFor='let transac of transacs'>
                                    <div class="row">
                                      <span class="col-md-8">{{transac.RegDate}}</span>
                                      <span class="col-md-4 text-right font-weight-bold">{{transac.Amount}}</span>
                                    </div>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </td>
                        </tr>
                      </ng-template>
                    </tbody>
                  </table>
                </div>
                <div class="row">
                  <div class="col-6">
                    <a><i class="icon ion-ios-arrow-left"></i></a>
                  </div>
                  <div class="col-6 text-right">
                    <a><i class="icon ion-ios-arrow-right pull right"></i></a>
                  </div>
                </div>
              </div>
              <div *ngIf="payment==undefined && contract!=undefined">
                <div class="row">
                  <span class="col-md-6">Гэрээний төлбөр</span>
                  <span class="col-md-6">{{contract.Income}}</span>
                </div>
                <br>
                <div class="alert alert-info">
                  Та төлбөрөө ХААН банкны 5027691218 дансанд төлснөөр гэрээ хүчинтэй болно.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
